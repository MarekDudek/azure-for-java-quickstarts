#!/usr/bin/env stack
{- stack script
 --resolver lts-16.31
 --install-ghc
 --package "command yaml"
 --ghc-options -Wall
-}
{-# LANGUAGE DataKinds, TypeOperators, TypeApplications, OverloadedStrings #-}

import System.Command
import qualified Data.Yaml as Y

main :: IO ()
main = do
    putStrLn "I'm generating deployment"
    Stdout out <- cmd ("kubectl create deployment rest-server --image marekdudek/rest-server --port 8082 -o yaml --dry-run=client" :: String)
    writeFile "./kubernetes/rest-server-deployment-2.yaml" out
    yamlTest

yamlTest :: IO ()
yamlTest = do
    res <- Y.decodeThrow "[1,2,3]"
    print (res :: [Integer])